(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{146:function(e,t,n){e.exports=n(610)},151:function(e,t,n){},153:function(e,t,n){},156:function(e,t,n){},610:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(17),s=n.n(i),o=(n(151),n(58)),l=n(59),u=n(63),c=n(60),p=n(62),m=n(16),d=(n(153),n(82));function f(e,t){var n=e[t];return(""===n.name?"p_"+t:n.name).replace(/ /g,"_")}function h(e,t,n,r,a){var i=e[t];if(i){if(i.visited)return n;i.ready=function(e,t){var n=!0;return Object.keys(e[t].inputs).map(function(t){e[t].ready||(n=!1)}),n}(e,t),i.ready&&(i.visited=!0,n.includes(t)||n.push(t),Object.keys(i.outputs).map(function(t){n=h(e,t,n,r+1,a)}))}return n}function g(e,t){var n={};return t.map(function(r,a){var i=e[r];r in n||(n[r]=f(e,r)+("Input"===i.specTitle?"":"_state"));var s=function(e,t,n){var r=-1;return t.map(function(t,a){n in e[t].inputs&&(r=Math.max(r,a))}),t[r]}(e,t,r);s&&(n[s]=n[r])}),n[t[t.length-1]]="self.state",n}function b(e){var t=[],n={},r=function(e){var t=0,n={};return Object.keys(e).map(function(r){var a=e[r];n[r]={specTitle:a.specs.title,inputs:{},outputs:{},name:a.name,ref:a.specs.ref,params:a.specs.params,index:null,visited:!1,downstreamVisited:!1,ready:!1,statename:null,needState:!1},"Input"===a.specs.title&&(n[r].index=t,n[r].ready=!0,n[r].statename=""===a.name?"input_"+t:a.name,t+=1)}),Object.keys(e).map(function(t){var r=n[t];Object.keys(e[t].outputs).map(function(e){r.outputs[e]=n[e],e in n?n[e].inputs[t]=n[t]:console.log(e,n)})}),n}(e);Object.keys(r).map(function(e){r[e].ready&&(t.push(e),n[e]=r[e])}),Object.keys(n).map(function(e){t=h(r,e,t,0,100)});var a=g(r,t);return{lib:r,order:t,states:a,inputs:Object.keys(n)}}function y(e,t,n){var r=!1;Object.keys(e).map(function(t){"Flatten"===e[t].specs.title&&(r=!0)});var a=t.order,i=t.states,s=t.inputs,o=function(e){var t="'''";return t+="\nCreated with https://mariusbrataas.github.io/flowpoints_ml/",e&&(t+="\n\nLink to model:\n"+e),t+="\n\nLICENSE:",t+="\nhttps://github.com/mariusbrataas/flowpoints_ml/blob/master/LICENSE",t+="\n'''"}(n);return o+="\n\n\n# Importing torch tools\nimport torch\nfrom torch import nn, optim, cuda\n\n\n# Importing other libraries\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport time",r&&(o+="\n\n\n# Helper class for flattening\nclass Flatten(nn.Module):\n    def __init__(self):\n        super(Flatten, self).__init__()\n    def forward(self, x):\n        return x.view(x.shape[0], -1)"),o+="\n\n\n"+function(e,t){var n="# Model";return n+="\nclass neural_net(nn.Module):",n+="\n\n\n    def __init__(self, optimizer=optim.SGD, alpha=0.01, criterion=nn.CrossEntropyLoss(), use_cuda=None):",n+="\n\n        # Basics",n+="\n        super(neural_net, self).__init__()",n+="\n\n        # Settings",n+="\n        self.optim_type = optimizer",n+="\n        self.optimizer  = None",n+="\n        self.alpha      = alpha",n+="\n        self.criterion  = criterion",n+="\n\n        # Use CUDA?",n+="\n        self.use_cuda = use_cuda if (use_cuda != None and cuda.is_available()) else cuda.is_available()",n+="\n\n        # Current loss and loss history",n+="\n        self.train_loss      = 0",n+="\n        self.valid_loss      = 0",n+="\n        self.train_loss_hist = []",n+="\n        self.valid_loss_hist = []",n+="\n\n        # State",n+="\n        self.state = None",n+="\n\n        # Adding all modules",t.map(function(t){var r=e[t];if("Input"!==r.specs.title){var a=0;Object.keys(r.specs.params).map(function(e){a=Math.max(e.length,a)}),n+="\n        self."+f(e,t)+" = "+r.specs.ref+"(",Object.keys(r.specs.params).map(function(e){n+="\n            "+e;for(var t=0;t<a-e.length;t++)n+=" ";n+=" = ","tuple"===r.specs.params[e].type?(n+="(",r.specs.params[e].current.map(function(t){n+=(""===t?r.specs.params[e].min:t)+","}),n=n.substring(0,n.length-1)+"),"):"select"===r.specs.params[e].type?n+="'"+(""===r.specs.params[e].current?r.specs.params[e].min:r.specs.params[e].current)+"',":n+=(""===r.specs.params[e].current?r.specs.params[e].min:r.specs.params[e].current)+","}),a>0&&(n+="\n        "),n+=")"}}),n+="\n\n        # Running startup routines",n+="\n        self.startup_routines()"}(e,a),o+="\n\n\n    def startup_routines(self):\n        self.optimizer = self.optim_type(self.parameters(), lr=self.alpha)\n        if self.use_cuda:\n            self.cuda()",o+="\n\n\n    def predict(self, x):\n        \n        # Switching off auto-grad\n        with torch.no_grad():\n            \n            # Use CUDA?\n            if self.use_cuda:\n                x = x.cuda()\n            \n            # Running inference\n            return self.forward(x)",o+="\n\n\n"+function(e,t,n,r){var a="    def forward(self, ";r.map(function(e){a+=t[e]+", "}),r.length>0&&(a=a.substring(0,a.length-2)),a+="):";var i=[];n.map(function(n){var r=e[n];if("Input"!==r.specTitle){var a="        "+t[n]+" = ";a+="self."+f(e,n)+"(",Object.keys(r.inputs).map(function(e){a+=t[e]+" + "}),a=a.substring(0,a.length-3)+")",i.push({msg:a,title:r.specTitle})}});var s=0;return i.map(function(e){s=Math.max(s,e.msg.length)}),i.map(function(e){a+="\n"+e.msg,Array.from(Array(s+1-e.msg.length).keys()).map(function(e){a+=" "}),a+="# "+e.title}),a+="\n        return self.state"}(t.lib,i,a,s),o+="\n\n\n    def fit_step(self, train_loader):\n\n        # Preparations for fit step\n        self.train_loss = 0 # Resetting training loss\n        self.train()        # Switching to autograd\n\n        # Looping through data\n        for x, y in train_loader:\n\n            # Use CUDA?\n            if self.use_cuda:\n                x, y = x.cuda(), y.cuda()        # Moving tensors to GPU\n\n            # Performing calculations\n            self.forward(x)                      # Forward pass\n            loss = self.criterion(self.state, y) # Calculating loss\n            self.train_loss += loss.item()       # Adding to epoch loss\n            loss.backward()                      # Backward pass\n            self.optimizer.step()                # Optimizing weights\n            self.optimizer.zero_grad()           # Clearing gradients\n\n        # Adding loss to history\n        self.train_loss_hist.append(self.train_loss / len(train_loader))",o+="\n\n\n    def validation_step(self, validation_loader):\n\n        # Preparations for validation step\n        self.valid_loss = 0 # Resetting validation loss\n\n        # Swithing off autograd\n        with torch.no_grad():\n\n            # Looping through data\n            for x, y in validation_loader:\n\n                # Use CUDA?\n                if self.use_cuda:\n                    x, y = x.cuda(), y.cuda()        # Moving tensors to GPU\n\n                # Performing calculations\n                self.forward(x)                      # Forward pass\n                loss = self.criterion(self.state, y) # Calculating loss\n                self.valid_loss += loss.item()       # Adding to epoch loss\n\n        # Adding loss to history\n        self.valid_loss_hist.append(self.valid_loss / len(validation_loader))",o+="\n\n\n    def fit(self, train_loader, validation_loader=None, epochs=10, show_progress=True, save_best=False):\n\n        # Helpers\n\n        best_validation = 1e5\n\n        # Possibly prepping progress message\n        if show_progress:\n            epoch_l = max(len(str(epochs)), 2)\n            print('Training model...')\n            print('%sEpoch   Training loss   Validation loss   Duration   Time remaining' % ''.rjust(2 * epoch_l - 4, ' '))\n            t = time.time()\n\n        # Looping through epochs\n        for epoch in range(epochs):\n            self.fit_step(train_loader)                 # Optimizing weights\n            if validation_loader != None:               # Perform validation?\n                self.validation_step(validation_loader) # Calculating validation loss\n\n            # Possibly printing progress\n            if show_progress:\n                eta_s = (time.time() - t) * (epochs - epoch)\n                eta = '%sm %ss' % (round(eta_s / 60), 60 - round(eta_s % 60))\n                print('%s/%s' % (str(epoch + 1).rjust(epoch_l, ' '), str(epochs).ljust(epoch_l, ' ')),\n                    '| %s' % str(round(self.train_loss_hist[-1], 8)).ljust(13, ' '),\n                    '| %s' % str(round(self.valid_loss_hist[-1], 8)).ljust(15, ' '),\n                    '| %ss' % str(round(time.time() - t, 3)).rjust(7, ' '),\n                    '| %s' % eta.ljust(14, ' '))\n                t = time.time()\n\n            # Possibly saving model\n            if save_best:\n                if self.valid_loss_hist[-1] < best_validation:\n                    self.save('best_validation')\n                    best_validation = self.valid_loss_hist[-1]\n\n        # Switching to eval\n        self.eval()",o+="\n\n\n    def plot_hist(self):\n\n        # Adding plots\n        plt.plot(self.train_loss_hist, color='blue', label='Training loss')\n        plt.plot(self.valid_loss_hist, color='springgreen', label='Validation loss')\n\n        # Axis labels\n        plt.xlabel('Epoch')\n        plt.ylabel('Loss')\n        plt.legend(loc='upper right')\n\n        # Displaying plot\n        plt.show()",o+="\n\n\n"+function(e,t){var n="    def save(self, name='model.pth'):";return n+="\n        if not '.pth' in name: name += '.pth'",n+="\n        torch.save({",t.map(function(t){if("Input"!==e[t].specTitle){var r=f(e,t);n+="\n            '"+r+"': self."+r+","}}),n+="\n            'train_loss':      self.train_loss,",n+="\n            'valid_loss':      self.valid_loss,",n+="\n            'train_loss_hist': self.train_loss_hist,",n+="\n            'valid_loss_hist': self.valid_loss_hist,",n+="\n            'optim_type':      self.optim_type,",n+="\n            'alpha':           self.alpha,",n+="\n            'criterion':       self.criterion,",n+="\n            'use_cuda':        self.use_cuda",n+="\n        }, name)",n+="\n\n\n    @staticmethod",n+="\n    def load(name='model.pth'):",n+="\n        if not '.pth' in name: name += '.pth'",n+="\n        checkpoint = torch.load(name)",n+="\n        model = neural_net(",n+="\n            optimizer = checkpoint['optim_type'],",n+="\n            alpha     = checkpoint['alpha'],",n+="\n            criterion = checkpoint['criterion'],",n+="\n            use_cuda  = checkpoint['use_cuda']",n+="\n        )",t.map(function(t){if("Input"!==e[t].specTitle){var r=f(e,t);n+="\n        model."+r+" = checkpoint['"+r+"']"}}),n+="\n        model.train_loss      = checkpoint['train_loss']",n+="\n        model.valid_loss      = checkpoint['valid_loss']",n+="\n        model.train_loss_hist = checkpoint['train_loss_hist']",n+="\n        model.valid_loss_hist = checkpoint['valid_loss_hist']",n+="\n        model.startup_routines()",n+="\n        return model"}(t.lib,a)}function v(){return{input:{title:"Input",params:{n_dims:{min:1,max:1/0,current:2},dimensions:{type:"tuple",min:1,max:1/0,current:[1,1]}},autoparams:function(e,t){return t},outshape:function(e,t){return t.dimensions.current}},linear:{title:"Linear",ref:"nn.Linear",id:0,params:{in_features:{type:"int",min:1,max:1/0,current:1},out_features:{type:"int",min:1,max:1/0,current:1},bias:{type:"bool",current:"True"}},outshape:function(e,t){var n=0,r=e.map(function(e,t){return n=t,e});return r[n]=t.out_features.current,r},autoparams:function(e,t){return t.in_features.current=e[e.length-1],t}},flatten:{title:"Flatten",ref:"Flatten",id:1,params:{},outshape:function(e,t){var n=1/e[0];return e.map(function(e){n*=e}),[e[0],Math.round(n)]},autoparams:function(e,t){return t}},conv1d:{title:"Conv1d",ref:"nn.Conv1d",id:2,params:{in_channels:{type:"int",min:1,max:1/0,current:1},out_channels:{type:"int",min:1,max:1/0,current:1},kernel_size:{type:"tuple",min:1,max:1/0,current:[3]},stride:{type:"tuple",min:1,max:1/0,current:[1]},padding:{type:"tuple",min:0,max:1/0,current:[0]},dilation:{type:"tuple",min:1,max:1/0,current:[1]},groups:{type:"int",min:1,max:1/0,current:1},bias:{type:"bool",current:"True"}},outshape:function(e,t){var n=e[2],r=Math.floor(1+(n+2*t.padding.current[0]-t.dilation.current[0]*(t.kernel_size.current[0]-1)-1)/t.stride.current[0]);return[e[0],t.out_channels.current.current,r]},autoparams:function(e,t){return t.in_channels.current=e[1],t}},conv2d:{title:"Conv2d",ref:"nn.Conv2d",id:3,params:{in_channels:{type:"int",min:1,max:1/0,current:1},out_channels:{type:"int",min:1,max:1/0,current:1},kernel_size:{type:"tuple",min:1,max:1/0,current:[3,3]},stride:{type:"tuple",min:1,max:1/0,current:[1,1]},padding:{type:"tuple",min:0,max:1/0,current:[0,0]},dilation:{type:"tuple",min:1,max:1/0,current:[1,1]},groups:{type:"int",min:1,max:1/0,current:1},bias:{type:"bool",current:"True"}},outshape:function(e,t){var n=e[2],r=e[3],a=Math.floor(1+(n+2*t.padding.current[0]-t.dilation.current[0]*(t.kernel_size.current[0]-1)-1)/t.stride.current[0]),i=Math.floor(1+(r+2*t.padding.current[1]-t.dilation.current[1]*(t.kernel_size.current[1]-1)-1)/t.stride.current[1]);return[e[0],t.out_channels.current,a,i]},autoparams:function(e,t){return t.in_channels.current=e[1],t}},conv3d:{title:"Conv3d",ref:"nn.Conv3d",id:4,params:{in_channels:{type:"int",min:1,max:1/0,current:1},out_channels:{type:"int",min:1,max:1/0,current:1},kernel_size:{type:"tuple",min:1,max:1/0,current:[3,3,3]},stride:{type:"tuple",min:1,max:1/0,current:[1,1,1]},padding:{type:"tuple",min:0,max:1/0,current:[0,0,0]},dilation:{type:"tuple",min:1,max:1/0,current:[1,1,1]},groups:{type:"int",min:1,max:1/0,current:1},bias:{type:"bool",current:"True"}},outshape:function(e,t){var n=e[2],r=e[3],a=e[4],i=Math.floor(1+(n+2*t.padding.current[0]-t.dilation.current[0]*(t.kernel_size.current[0]-1)-1)/t.stride.current[0]),s=Math.floor(1+(r+2*t.padding.current[1]-t.dilation.current[1]*(t.kernel_size.current[1]-1)-1)/t.stride.current[1]),o=Math.floor(1+(a+2*t.padding.current[2]-t.dilation.current[2]*(t.kernel_size.current[2]-1)-1)/t.stride.current[2]);return[e[0],t.out_channels.current,i,s,o]},autoparams:function(e,t){return t.in_channels.current=e[1],t}},maxpool1d:{title:"MaxPool1d",ref:"nn.MaxPool1d",id:5,params:{kernel_size:{type:"int",min:1,max:1/0,current:3},stride:{type:"int",min:1,max:1/0,current:1},padding:{type:"int",min:0,max:1/0,current:0},dilation:{type:"int",min:1,max:1/0,current:1},return_indices:{type:"bool",current:"False"},ceil_mode:{type:"bool",current:"False"}},outshape:function(e,t){var n=e[2],r=Math.floor(1+(n+2*t.padding.current[0]-t.dilation.current[0]*(t.kernel_size.current[0]-1)-1)/t.stride.current[0]);return[e[0],e[0],r]},autoparams:function(e,t){return t}},maxpool2d:{title:"MaxPool2d",ref:"nn.MaxPool2d",id:6,params:{kernel_size:{type:"tuple",min:1,max:1/0,current:[3,3]},stride:{type:"tuple",min:1,max:1/0,current:[1,1]},padding:{type:"tuple",min:0,max:1/0,current:[0,0]},dilation:{type:"tuple",min:1,max:1/0,current:[1,1]},return_indices:{type:"bool",current:"False"},ceil_mode:{type:"bool",current:"False"}},outshape:function(e,t){var n=e[2],r=e[3],a=Math.floor(1+(n+2*t.padding.current[0]-t.dilation.current[0]*(t.kernel_size.current[0]-1)-1)/t.stride.current[0]),i=Math.floor(1+(r+2*t.padding.current[1]-t.dilation.current[1]*(t.kernel_size.current[1]-1)-1)/t.stride.current[1]);return[e[0],e[1],a,i]},autoparams:function(e,t){return t}},maxpool3d:{title:"MaxPool3d",ref:"nn.MaxPool3d",id:7,params:{kernel_size:{type:"tuple",min:1,max:1/0,current:[3,3,3]},stride:{type:"tuple",min:1,max:1/0,current:[1,1,1]},padding:{type:"tuple",min:0,max:1/0,current:[0,0,0]},dilation:{type:"tuple",min:1,max:1/0,current:[1,1,1]},return_indices:{type:"bool",current:"False"},ceil_mode:{type:"bool",current:"False"}},outshape:function(e,t){var n=e[2],r=e[3],a=e[4],i=Math.floor(1+(n+2*t.padding.current[0]-t.dilation.current[0]*(t.kernel_size.current[0]-1)-1)/t.stride.current[0]),s=Math.floor(1+(r+2*t.padding.current[1]-t.dilation.current[1]*(t.kernel_size.current[1]-1)-1)/t.stride.current[1]),o=Math.floor(1+(a+2*t.padding.current[2]-t.dilation.current[2]*(t.kernel_size.current[2]-1)-1)/t.stride.current[2]);return[e[0],e[1],i,s,o]},autoparams:function(e,t){return t}},batchnorm1d:{title:"BatchNorm1d",ref:"nn.BatchNorm1d",id:8,params:{num_features:{type:"int",min:1,max:1/0,current:1},eps:{type:"double",min:1e-5,max:1,current:1e-5},momentum:{type:"double",min:0,max:1/0,current:.1},affine:{type:"bool",current:"True"},track_running_stats:{type:"bool",current:"True"}},outshape:function(e,t){return e},autoparams:function(e,t){return t.num_features.current=e[1],t}},batchnorm2d:{title:"BatchNorm2d",ref:"nn.BatchNorm2d",id:9,params:{num_features:{type:"int",min:1,max:1/0,current:1},eps:{type:"double",min:1e-5,max:1,current:1e-5},momentum:{type:"double",min:0,max:1/0,current:.1},affine:{type:"bool",current:"True"},track_running_stats:{type:"bool",current:"True"}},outshape:function(e,t){return e},autoparams:function(e,t){return t.num_features.current=e[1],t}},batchnorm3d:{title:"BatchNorm3d",ref:"nn.BatchNorm3d",id:10,params:{num_features:{type:"int",min:1,max:1/0,current:1},eps:{type:"double",min:1e-5,max:1,current:1e-5},momentum:{type:"double",min:0,max:1/0,current:.1},affine:{type:"bool",current:"True"},track_running_stats:{type:"bool",current:"True"}},outshape:function(e,t){return e},autoparams:function(e,t){return t.num_features.current=e[1],t}},groupnorm:{title:"GroupNorm",ref:"nn.GroupNorm",id:11,params:{num_groups:{type:"int",min:1,max:1/0,current:1},num_channels:{type:"int",min:1,max:1/0,current:1},eps:{type:"double",min:1e-5,max:1,current:1e-5},affine:{type:"bool",current:"True"}},outshape:function(e,t){return e},autoparams:function(e,t){return t.num_channels.current=e[1],t}},instancenorm1d:{title:"InstanceNorm1d",ref:"nn.InstanceNorm1d",id:12,params:{num_features:{type:"int",min:1,max:1/0,current:1},eps:{type:"double",min:1e-5,max:1,current:1e-5},momentum:{type:"double",min:0,max:1/0,current:.1},affine:{type:"bool",current:"False"},track_running_stats:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t.num_features.current=e[1],t}},instancenorm2d:{title:"InstanceNorm2d",ref:"nn.InstanceNorm2d",id:13,params:{num_features:{type:"int",min:1,max:1/0,current:1},eps:{type:"double",min:1e-5,max:1,current:1e-5},momentum:{type:"double",min:0,max:1/0,current:.1},affine:{type:"bool",current:"False"},track_running_stats:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t.num_features.current=e[1],t}},instancenorm3d:{title:"InstanceNorm3d",ref:"nn.InstanceNorm3d",id:14,params:{num_features:{type:"int",min:1,max:1/0,current:1},eps:{type:"double",min:1e-5,max:1,current:1e-5},momentum:{type:"double",min:0,max:1/0,current:.1},affine:{type:"bool",current:"False"},track_running_stats:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t.num_features.current=e[1],t}},rnn:{title:"RNN",ref:"nn.RNN",id:15,params:{input_size:{type:"int",min:1,max:1/0,current:1},hidden_size:{type:"int",min:1,max:1/0,current:1},num_layers:{type:"int",min:1,max:1/0,current:1},nonlinearity:{type:"select",options:["relu","tanh"],current:"tanh"},bias:{type:"bool",current:"True"},batch_first:{type:"bool",current:"False"},dropout:{type:"double",min:0,max:1/0,current:0},bidirectional:{type:"bool",current:"False"}},outshape:function(e,t){var n=0,r=e.map(function(e,t){return n=t,e});return r[n]=t.hidden_size.current,r},autoparams:function(e,t){return t.input_size.current=e[e.length-1],t}},lstm:{title:"LSTM",ref:"nn.LSTM",id:16,params:{input_size:{type:"int",min:1,max:1/0,current:1},hidden_size:{type:"int",min:1,max:1/0,current:1},num_layers:{type:"int",min:1,max:1/0,current:1},bias:{type:"bool",current:"True"},batch_first:{type:"bool",current:"False"},dropout:{type:"double",min:0,max:1/0,current:0},bidirectional:{type:"bool",current:"False"}},outshape:function(e,t){var n=0,r=e.map(function(e,t){return n=t,e});return r[n]=t.hidden_size.current,r},autoparams:function(e,t){return t.input_size.current=e[e.length-1],t}},gru:{title:"GRU",ref:"nn.GRU",id:17,params:{input_size:{type:"int",min:1,max:1/0,current:1},hidden_size:{type:"int",min:1,max:1/0,current:1},num_layers:{type:"int",min:1,max:1/0,current:1},bias:{type:"bool",current:"True"},batch_first:{type:"bool",current:"False"},dropout:{type:"double",min:0,max:1/0,current:0},bidirectional:{type:"bool",current:"False"}},outshape:function(e,t){var n=0,r=e.map(function(e,t){return n=t,e});return r[n]=t.hidden_size.current,r},autoparams:function(e,t){return t.input_size.current=e[e.length-1],t}},rnncell:{title:"RNNCell",ref:"nn.RNNCell",id:18,params:{input_size:{type:"int",min:1,max:1/0,current:1},hidden_size:{type:"int",min:1,max:1/0,current:1},bias:{type:"bool",current:"True"},nonlinearity:{type:"select",options:["relu","tanh"],current:"tanh"}},outshape:function(e,t){var n=0,r=e.map(function(e,t){return n=t,e});return r[n]=t.hidden_size.current,r},autoparams:function(e,t){return t.input_size.current=e[e.length-1],t}},lstmcell:{title:"LSTMCell",ref:"nn.LSTMCell",id:19,params:{input_size:{type:"int",min:1,max:1/0,current:1},hidden_size:{type:"int",min:1,max:1/0,current:1},bias:{type:"bool",current:"True"}},outshape:function(e,t){var n=0,r=e.map(function(e,t){return n=t,e});return r[n]=t.hidden_size.current,r},autoparams:function(e,t){return t.input_size.current=e[e.length-1],t}},grucell:{title:"GRUCell",ref:"nn.GRUCell",id:20,params:{input_size:{type:"int",min:1,max:1/0,current:1},hidden_size:{type:"int",min:1,max:1/0,current:1},bias:{type:"bool",current:"True"}},outshape:function(e,t){var n=0,r=e.map(function(e,t){return n=t,e});return r[n]=t.hidden_size.current,r},autoparams:function(e,t){return t.input_size.current=e[e.length-1],t}},dropout:{title:"Dropout",ref:"nn.Dropout",id:21,params:{p:{type:"double",min:0,max:1,current:.5},inplace:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},dropout2d:{title:"Dropout2d",ref:"nn.Dropout2d",id:22,params:{p:{type:"double",min:0,max:1,current:.5},inplace:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},dropout3d:{title:"Dropout3d",ref:"nn.Dropout3d",id:23,params:{p:{type:"double",min:0,max:1,current:.5},inplace:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},alphadropout:{title:"AlphaDropout",ref:"nn.AlphaDropout",id:24,params:{p:{type:"double",min:0,max:1,current:.5},inplace:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},elu:{title:"ELU",ref:"nn.ELU",id:25,params:{alpha:{type:"double",min:0,max:1/0,current:1},inplace:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},hardshrink:{title:"Hardshrink",ref:"nn.Hardshrink",id:26,params:{lambd:{type:"double",min:-1/0,max:1/0,current:"0.5"}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},hardtanh:{title:"Hardtanh",ref:"nn.Hardtanh",id:27,params:{min_val:{type:"double",min:-1/0,max:1/0,current:-1},max_val:{type:"double",min:-1/0,max:1/0,current:1},inplace:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},leakyrelu:{title:"LeakyReLU",ref:"nn.LeakyReLU",id:28,params:{negative_slope:{type:"double",min:0,max:1/0,current:.01},inplace:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},logsigmoid:{title:"LogSigmoid",ref:"nn.LogSigmoid",id:29,params:{},outshape:function(e,t){return e},autoparams:function(e,t){return t}},prelu:{title:"PReLU",ref:"nn.PReLU",id:30,params:{num_parameters:{type:"int",min:0,max:1/0,current:1},init:{type:"double",min:0,max:1/0,current:.25}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},relu:{title:"ReLU",ref:"nn.ReLU",id:31,params:{inplace:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},relu6:{title:"ReLU6",ref:"nn.ReLU6",id:32,params:{inplace:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},rrelu:{title:"RReLU",ref:"nn.RReLU",id:33,params:{lower:{type:"double",min:0,max:1/0,current:1/8},upper:{type:"double",min:0,max:1/0,current:1/3},inplace:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},selu:{title:"SELU",ref:"nn.SELU",id:34,params:{inplace:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},celu:{title:"CELU",ref:"nn.CELU",id:35,params:{alpha:{type:"double",min:0,max:1/0,current:1},inplace:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},sigmoid:{title:"Sigmoid",ref:"nn.Sigmoid",id:36,params:{},outshape:function(e,t){return e},autoparams:function(e,t){return t}},softplus:{title:"Softplus",ref:"nn.Softplus",id:37,params:{beta:{type:"double",min:0,max:1/0,current:1},threshold:{type:"double",min:0,max:1/0,current:20}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},softshrink:{title:"Softshrink",ref:"nn.Softshrink",id:38,params:{lambd:{type:"double",min:0,max:1/0,current:.5}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},softsign:{title:"Softsign",ref:"nn.Softsign",id:39,params:{},outshape:function(e,t){return e},autoparams:function(e,t){return t}},tanh:{title:"Tanh",ref:"nn.Tanh",id:40,params:{},outshape:function(e,t){return e},autoparams:function(e,t){return t}},tanhshrink:{title:"Tanhshrink",ref:"nn.Tanhshrink",id:41,params:{},outshape:function(e,t){return e},autoparams:function(e,t){return t}},threshold:{title:"Threshold",ref:"nn.Threshold",id:42,params:{threshold:{type:"double",min:0,max:1/0,current:.1},value:{type:"double",min:0,max:1/0,current:.1},inplace:{type:"bool",current:"False"}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},softmin:{title:"Softmin",ref:"nn.Softmin",id:43,params:{dim:{type:"int",min:0,max:1/0,current:-1}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},softmax:{title:"Softmax",ref:"nn.Softmax",id:44,params:{dim:{type:"int",min:0,max:1/0,current:-1}},outshape:function(e,t){return e},autoparams:function(e,t){return t}},softmax2d:{title:"Softmax2d",ref:"nn.Softmax2d",id:45,params:{},outshape:function(e,t){return e},autoparams:function(e,t){return t}},logsoftmax:{title:"LogSoftmax",ref:"nn.LogSoftmax",id:46,params:{dim:{type:"int",min:0,max:1/0,current:-1}},outshape:function(e,t){return e},autoparams:function(e,t){return t}}}}n(156);var _=n(615),x=n(43),k=n(57),w=n.n(k),S=n(24),E=n(131),C=n.n(E),T=n(133),O=n.n(T),F=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(c.a)(t).call(this,e))).state={value:void 0!==e.tab?e.tabs.indexOf(e.tab):0},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state.value,r=Math.ceil(this.props.width/this.props.tabs.length)+"px";return a.a.createElement("div",{className:t.root,style:{overflow:"hidden"}},a.a.createElement(C.a,{value:n,onChange:function(t,n){e.setState({value:n}),e.props.onSelectTab&&e.props.onSelectTab(e.props.tabs[n])},textColor:"primary",classes:{root:t.tabsRoot,indicator:t.tabsIndicator},scrollButtons:!1},this.props.tabs.map(function(e){return a.a.createElement(O.a,{disableRipple:!0,classes:{root:t.tabRoot,selected:t.tabSelected},label:e,style:{width:r}})})))}}]),t}(a.a.Component),j=Object(S.withStyles)(function(e){return{root:{flexGrow:1,overflow:"scroll"},tabsRoot:{borderBottom:"1px solid #1890ff"},tabsIndicator:{backgroundColor:"#1890ff"},tabRoot:{textTransform:"initial",minWidth:50,fontWeight:e.typography.fontWeightRegular,marginRight:0*e.spacing.unit,fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),"&:hover":{color:"#40a9ff",opacity:1},"&$tabSelected":{color:"#1890ff"},"&:focus":{color:"#40a9ff"}},tabSelected:{},typography:{padding:0*e.spacing.unit}}})(F),M=n(37),z=n.n(M),P=n(26),L=n.n(P),R=n(34),N=n.n(R),U=n(25),A=n.n(U),I=n(139),D=n.n(I),B=n(134),H=n.n(B),W=n(138),G=n.n(W),V=n(33),q=n.n(V),Q=n(38),$=n.n(Q),J=n(83),K=n.n(J),X=n(84),Y=n.n(X),Z=n(35),ee=n.n(Z),te=n(66),ne=n(259),re=Object(S.createMuiTheme)({palette:{type:"dark"},typography:{useNextVariants:!0}}),ae=Object(S.createMuiTheme)({palette:{type:"light"},typography:{useNextVariants:!0}});x.github.hljs.background="#ffffff";var ie=["red","pink",,"purple","deep-purple","indigo","blue","light-blue","green","light-green","lime","yellow","amber","orange","deep-orange","brown","grey","blue-grey","black","white"],se=function(e){var t=e.environment;return a.a.createElement("div",{style:{padding:"15px"}},a.a.createElement("div",null,a.a.createElement("h3",{style:{marginTop:"0px"}},"Environment"),a.a.createElement(A.a,null,a.a.createElement(N.a,{htmlFor:"libSelect"},"Library"),a.a.createElement(L.a,{value:t.library,inputProps:{name:"library select",id:"libSelect"},onChange:function(t){var n=e.refresh().environment;n.library=t.target.value,e.updateEnv(n)}},t.libraries.map(function(e){return a.a.createElement(z.a,{value:e},e)})))),a.a.createElement("div",{style:{paddingTop:"20px"}},a.a.createElement("h3",null,"Customize view"),a.a.createElement("div",{style:{paddingBottom:10}},a.a.createElement(A.a,{style:{width:"48%",paddingRight:10,paddingBottom:10}},a.a.createElement(N.a,{htmlFor:"themeselect"},"Theme"),a.a.createElement(L.a,{value:e.settings.theme,inputProps:{name:"theme select",id:"themeselect"},onChange:function(t){var n=e.refresh().settings;n.theme=t.target.value,e.updateSettings(n)}},ie.map(function(e){return a.a.createElement(z.a,{value:e},e)}))),a.a.createElement(A.a,{style:{width:"48%"}},a.a.createElement(N.a,{htmlFor:"varselect"},"Variant"),a.a.createElement(L.a,{value:e.settings.variant,inputProps:{name:"vairant select",id:"varselect"},onChange:function(t){var n=e.refresh().settings;n.variant=t.target.value,e.updateSettings(n)}},["paper","outlined","filled"].map(function(e){return a.a.createElement(z.a,{value:e},e)})))),[{r:"darktheme",t:"Dark theme"},{r:"showName",t:"Show names"},{r:"showShape",t:"Show shapes"},{r:"avoidCollisions",t:"Avoid collisions"}].map(function(t){return a.a.createElement(K.a,{style:{paddingTop:0},control:a.a.createElement(Y.a,{checked:e.settings[t.r],color:"primary",onChange:function(n){var r=e.refresh().settings;r[t.r]=!r[t.r],e.updateSettings(r)}}),label:t.t})})),a.a.createElement("div",{style:{paddingTop:20}},a.a.createElement(H.a,{variant:"outlined",onClick:function(t){ne.toPng(e.diagramRef).then(function(e){(new Image).src=e;var t=document.createElement("a");t.download="diagram.png",t.href=e,t.click()})}},"Export png")))},oe=function(e){e.environment.library;var t=e.darktheme?x.atelierForestDark:x.github;return a.a.createElement("div",{style:{fontSize:12}},a.a.createElement(_.a,{language:"python",style:t,showLineNumbers:!0},e.code))},le=function(e){var t=e.flowpoints[e.selected];if(t){var n=t.specs.params,r={int:[],double:[],bool:[],tuple:[],select:[]};"Input"===t.specs.title&&r.int.push(a.a.createElement($.a,{label:"N dimensions",type:"number",variant:"outlined",margin:"dense",style:{width:"155px",paddingRight:"5px"},value:n.n_dims.current,onChange:function(t){var n=e.refresh().flowpoints[e.selected],r=n.specs.params;r.n_dims.current=Math.max(Math.min(t.target.value,r.n_dims.max),r.n_dims.min),r.n_dims.current<r.dimensions.current.length?r.dimensions.current=r.dimensions.current.splice(0,r.n_dims.current):r.n_dims.current>r.dimensions.current.length&&Array.from(Array(r.n_dims.current-r.dimensions.current.length).keys()).map(function(e){r.dimensions.current.push(1)}),e.updatePointSettings(e.selected,n)}})),Object.keys(n).map(function(t){var i=n[t];switch(i.type){case"int":r.int.push(a.a.createElement($.a,{label:t,type:"number",variant:"outlined",margin:"dense",style:{width:"155px",paddingRight:"5px"},value:n[t].current,onChange:function(n){var r=e.refresh().flowpoints[e.selected],a=r.specs.params[t];a.current=""===n.target.value?"":Math.max(Math.min(n.target.value,a.max),a.min),e.updatePointSettings(e.selected,r)}}));break;case"double":r.double.push(a.a.createElement($.a,{label:t,type:"number",variant:"outlined",margin:"dense",style:{width:"155px",paddingRight:"5px"},value:n[t].current,onChange:function(n){var r=e.refresh().flowpoints[e.selected],a=r.specs.params[t];a.current=""===n.target.value?"":Math.max(Math.min(n.target.value,a.max),a.min),e.updatePointSettings(e.selected,r)}}));break;case"bool":r.bool.push(a.a.createElement(K.a,{control:a.a.createElement(Y.a,{checked:"True"===i.current,color:"primary",onChange:function(n){var r=e.refresh().flowpoints[e.selected],a=r.specs.params[t];"True"===a.current?a.current="False":a.current="True",e.updatePointSettings(e.selected,r)}}),label:t}));break;case"tuple":r.tuple.push(a.a.createElement("div",{style:{paddingTop:"15px"}},a.a.createElement("div",null,a.a.createElement("h5",{style:{margin:"0px"}},t)),i.current.map(function(n,r){return a.a.createElement($.a,{label:t+" "+r,type:"number",variant:"outlined",margin:"dense",style:{width:"155px",paddingRight:"5px"},value:n,onChange:function(n){var a=e.refresh().flowpoints,i=a[e.selected],s=a[e.selected].specs.params[t];s.current[r]=""===n.target.value?"":Math.max(Math.min(n.target.value,s.max),s.min),e.updatePointSettings(e.selected,i)}})})));break;case"select":r.select.push(a.a.createElement(A.a,null,a.a.createElement(N.a,{htmlFor:"selectfield"},t),a.a.createElement(L.a,{value:n[t].options.indexOf(n[t].current),style:{width:"155px",paddingRight:"5px"},onChange:function(n){var r=e.refresh().flowpoints[e.selected],a=r.specs.params[t];a.current=a.options[n.target.value],e.updatePointSettings(e.selected,r)},inputProps:{id:"selectfield"}},n[t].options.map(function(e,t){return a.a.createElement(z.a,{value:t},e)}))))}});var i=e.environment.getModules(),s={};return Object.keys(i).map(function(e){s[i[e].title]=e}),a.a.createElement("div",{style:{padding:"15px"}},a.a.createElement("div",null,a.a.createElement("h2",{style:{marginTop:"0px"}},"Flowpoint settings"),a.a.createElement(A.a,{style:{width:"100%"}},a.a.createElement(L.a,{value:t.specs.title,inputProps:{name:"spec select",id:"specselect"},onChange:function(t){if(t.target.value in s){var n=e.refresh().flowpoints[e.selected];n.specs=i[s[t.target.value]],e.updatePointSettings(e.selected,n)}}},Object.keys(s).map(function(e){return a.a.createElement(z.a,{value:e},e)}))),a.a.createElement($.a,{label:"Name",value:t.name,margin:"tight",style:{width:"80%"},onChange:function(t){var n=e.refresh().flowpoints[e.selected];n.name=t.target.value,e.updatePointSettings(e.selected,n)}}),a.a.createElement(ee.a,{"aria-label":"Delete",color:q.a[500],style:{marginLeft:10,marginTop:5,color:q.a[300]},onClick:e.deleteSelected},a.a.createElement(G.a,null))),a.a.createElement("div",{style:{paddingTop:"25px"}},a.a.createElement("h3",null,"Parameters"),a.a.createElement("div",null,r.int),a.a.createElement("div",null,r.double),a.a.createElement("div",null,r.select),a.a.createElement("div",null,r.tuple),a.a.createElement("div",null,r.bool)))}return a.a.createElement("div",{style:{display:"table",width:"100%",height:"50px"}},a.a.createElement("div",{style:{display:"table-cell",verticalAlign:"middle",textAlign:"center"}},"Click on a flowpoint to display it's settings."))},ue=function(e){return a.a.createElement(S.MuiThemeProvider,{theme:e.darktheme?re:ae},a.a.createElement(D.a,{variant:"persistent",anchor:"left",open:e.open},a.a.createElement("div",{class:"fullSidebar",style:{maxWidth:e.settings.drawerWidth,color:e.darktheme?"white":"black"}},a.a.createElement(w.a,{gutterBottom:!0,variant:"h5",component:"h2",style:{padding:"15px"}},"Flowpoints ML"),a.a.createElement("div",{style:{position:"absolute",right:5,top:5}},a.a.createElement(ee.a,{target:"_blank",href:"https://www.npmjs.com/package/flowpoints"},a.a.createElement(te.c,null)),a.a.createElement(ee.a,{target:"_blank",href:"https://www.linkedin.com/in/marius-brataas-355567106/"},a.a.createElement(te.b,null)),a.a.createElement(ee.a,{target:"_blank",href:"https://github.com/mariusbrataas/flowpoints_ml#readme"},a.a.createElement(te.a,null))),a.a.createElement("div",null,a.a.createElement(j,{tabs:["Misc","Code","Flowpoint"],tab:e.settings.tab,width:350,onSelectTab:function(t){var n=e.refresh().settings;n.tab=t,n.drawerWidth="Code"===t?600:350,e.updateSettings(n)}})),a.a.createElement("div",{class:"scrollBox",style:{backgroundColor:e.darktheme?x.atelierForestDark.hljs.background:null}},a.a.createElement("div",null,"Misc"===e.settings.tab?a.a.createElement(se,{environment:e.environment,flowpoints:e.flowpoints,refresh:e.refresh,updateEnv:e.updateEnv,settings:e.settings,updateSettings:e.updateSettings,diagramRef:e.diagramRef}):null,"Code"===e.settings.tab?a.a.createElement(oe,{environment:e.environment,flowpoints:e.flowpoints,refresh:e.refresh,code:e.code,darktheme:e.darktheme}):null,"Flowpoint"===e.settings.tab?a.a.createElement(le,{selected:e.selected,settings:e.settings,environment:e.environment,flowpoints:e.flowpoints,refresh:e.refresh,deleteSelected:e.deleteSelected,updatePointSettings:e.updatePointSettings}):null)))))},ce=["red","pink",,"purple","deep-purple","indigo","blue","light-blue","green","light-green","lime","yellow","amber","orange","deep-orange","brown","grey","blue-grey","black","white"],pe={0:"$",1:"(",2:")",3:"-"};function me(e){return e.toString(36)}function de(e){return parseInt(e,36)}function fe(e,t){var n=t.params,r=e.split(pe[2]);return Object.keys(n).sort().map(function(e,t){var a=n[e],i=r[t];"bool"===a.type?a.current="t"===i?"True":"False":"tuple"===a.type?i.split(pe[3]).map(function(e,t){a.current[t]=de(e)}):"select"===a.type?a.current=a.options[i]:"int"===a.type?a.current=de(i):a.current=i}),t.params=n,t}function he(e){var t={a:"auto",t:"top",l:"left",r:"right",b:"bottom"},n=e.split(pe[2]),r={};return n.map(function(e){""!==e&&(r[e.substring(0,e.length-2)]={output:t[e[e.length-2]],input:t[e[e.length-1]]})}),r}function ge(e,t){var n=""+t;return n+=pe[1]+e.name,n+=pe[1]+me(Math.round(e.pos.x/10)),n+=pe[1]+me(Math.round(e.pos.y/10)),n+=pe[1]+("Input"===e.specs.title?"":me(e.specs.id)),n+=pe[1]+function(e){var t="";return Object.keys(e).map(function(n){t+=me(n)+e[n].output[0]+e[n].input[0]+pe[2]}),Object.keys(e).length>0&&(t=t.substring(0,t.length-pe[2].length)),t}(e.outputs),n+=pe[1]+function(e){var t="";return Object.keys(e).sort().map(function(n){var r=e[n];"bool"===r.type?t+="True"===r.current?"t":"f":"tuple"===r.type?(r.current.map(function(e){t+=me(e)+pe[3]}),t=t.substring(0,t.length-pe[3].length)):"select"===r.type?t+=r.options.indexOf(r.current):"int"===r.type?t+=me(r.current):t+=r.current,t+=pe[2]}),t.substring(0,t.length-pe[2].length)}(e.specs.params)}function be(e){var t=(e=e.replace(/%20/g," ")).split(pe[0]),n={P:{t:"PyTorch",modules:v}},r={library:n[e[0]].t,getModules:n[e[0]].modules,darktheme:"D"===e[4],showName:"T"===e[5],showSidebar:"T"===e[6],count:de(t[0]),theme:ce[de(e[1])],variant:{0:"paper",1:"outlined",2:"filled"}[e[2]],background:ce[de(e[3])]},a={},i=r.getModules();Object.keys(i).map(function(e){a[i[e].id]=e});var s={};return t.splice(2,t.length).map(function(e){var t=function(e,t,n){var r=e.split(pe[1]),a={name:r[1],output_shape:[],pos:{x:10*de(r[2]),y:10*de(r[3])},specs:fe(r[6],n()[""===r[4]?"input":t[de(r[4])]]),outputs:he(r[5]),isHover:!1};return{key:r[0],p:a}}(e,a,r.getModules);s[t.key]=t.p}),r.flowpoints=s,Object.keys(s).map(function(e){"Input"===s[e].specs.title&&(s[e].specs.params.n_dims.current=s[e].specs.params.dimensions.current.length)}),r}var ye=n(85),ve=n.n(ye);function _e(e,t){var n=function(e){e=Math.min(20,Math.max(10,e||15));var t=new Date,n="";n+=""+t.getSeconds(),n+=""+t.getMonth(),n+=""+t.getYear().toString().substring(1),n+=""+t.getHours(),n+=""+t.getMinutes();var r=parseInt(n).toString(36),a="abcdefghijklmnopqrstuvwxyz0123456789";return Array.from(Array(e-r.length).keys()).map(function(e){r=a[Math.floor(Math.random()*a.length)]+r}),r}(),r="https://docs.google.com/forms/d/e/1FAIpQLSe0t-CqzF_5Axf40bLIHqFQXL11G7pEdfZaR0L7eHNWl8Y-7g/formResponse?usp=pp_url";r+="&entry.310443767="+n,r+="&entry.65336938="+e,r+="&submit=Submit",ve.a.get(r).then(function(e){}),t(n)}var xe=n(36),ke=n.n(xe),we=n(80),Se=n.n(we),Ee=n(144),Ce=n.n(Ee),Te=n(141),Oe=n.n(Te),Fe=n(142),je=n.n(Fe),Me=n(145),ze=n.n(Me),Pe=n(81),Le=n.n(Pe),Re=n(87),Ne=n.n(Re),Ue=n(65),Ae=n.n(Ue),Ie=n(61),De=n.n(Ie),Be=n(143),He=n.n(Be),We=n(140),Ge=n.n(We),Ve=n(86),qe=n.n(Ve);function Qe(e,t,n){var r="";return e.split(t).map(function(e){r+=e+n}),r.substring(0,r.length-n.length)}var $e=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(c.a)(t).call(this,e))).state={lastPos:{x:50,y:-40},code:"",selected:null,count:0,flowpoints:{},current_url:"",url:"",settings:{tab:"Misc",theme:"indigo",background:"white",variant:"outlined",drawerWidth:350,darktheme:!1,showShape:!1,showName:!1,showSidebar:!0,avoidCollisions:!0,snackshow:!1,snackmsg:"Hello world",snackcolor:Ne.a.A700,modelUrl:null},environment:{library:"PyTorch",libraries:["PyTorch"],getModules:v}},n.baseUrl=window.location.href.split("/?")[0],"/"!==n.baseUrl[n.baseUrl.length-1]&&(n.baseUrl+="/"),n.lib={},n.diagramRef=null,n.addFlowpoint=n.addFlowpoint.bind(Object(m.a)(Object(m.a)(n))),n.handleClickPoint=n.handleClickPoint.bind(Object(m.a)(Object(m.a)(n))),n.deleteSelected=n.deleteSelected.bind(Object(m.a)(Object(m.a)(n))),n.prepCode=n.prepCode.bind(Object(m.a)(Object(m.a)(n))),n.prepOutputShapes=n.prepOutputShapes.bind(Object(m.a)(Object(m.a)(n))),n.updatePointSettings=n.updatePointSettings.bind(Object(m.a)(Object(m.a)(n))),n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.onbeforeunload=function(t){if(e.state.count>0)return"Any unsaved data will be lost"};var t,n=window.location.href.split(this.baseUrl)[1];if(n.includes("p=")){(r=this.state.settings).snackshow=!0,r.snackmsg="Trying to load model",r.snackcolor=Ae.a.A700,r.modelUrl=this.baseUrl+n.substring(0,18),this.setState({settings:r});try{t=function(t){if(n=t[n=n.split("?p=")[1].substring(0,15)]){var a=be(n=Qe(n,"lll","."));r=e.state.settings;var i=e.state.environment;r.darktheme=a.darktheme,r.showName=a.showName,r.theme=a.theme,r.background=a.background,r.variant=a.variant,r.showSidebar=a.showSidebar,i.library=a.library,r.snackshow=!0,r.snackmsg="Loaded model from URL",r.snackcolor=Ne.a.A700,e.setState({count:a.count,flowpoints:a.flowpoints,settings:r,environment:i},function(){e.prepOutputShapes(),e.prepCode()})}},ve.a.get("https://docs.google.com/spreadsheets/d/1npVr6xkN7hBzMQe-x_ao0T_tTDVTTzLetgvCUtG4k70/export?format=csv&id=1qNBuXr5KIHPHqoNBgZEao2F3rAjBtMiQf6fsEDug0mk&gid=0").then(function(e){for(var n,r={},a=e.data.split("\r\n"),i=1;i<a.length;i++)r[(n=a[i].split(","))[0]]=n[1];t(r)})}catch(a){var r;console.log(a),(r=this.state.settings).snackshow=!0,r.snackmsg="Failed to load from URL",r.snackcolor=q.a.A400,this.setState({settings:r})}}else this.prepOutputShapes(),this.prepCode()}},{key:"prepCode",value:function(){var e=null;"PyTorch"===this.state.environment.library&&(e=y),this.setState({code:e(this.state.flowpoints,this.lib,this.state.settings.modelUrl)+"\n\n\n"})}},{key:"prepOutputShapes",value:function(){var e=this,t=this.state.flowpoints;this.lib=b(t);var n=[];this.lib.order.map(function(r){"Input"===e.lib.lib[r].specTitle&&(t[r].output_shape=t[r].specs.outshape(null,t[r].specs.params),n.push(r))}),this.lib.order.map(function(r){if(!n.includes(r)){var a=null;Object.keys(e.lib.lib[r].inputs).map(function(e){n.includes(e)&&(a=e)}),t[r].specs.params=t[r].specs.autoparams(t[a].output_shape,t[r].specs.params),t[r].output_shape=t[r].specs.outshape(t[a].output_shape,t[r].specs.params),n.push(r)}}),this.setState({flowpoints:t})}},{key:"updatePointSettings",value:function(e,t){var n=this.state.flowpoints;n[e]=t,this.setState({flowpoints:n}),this.prepOutputShapes(),this.prepCode()}},{key:"deleteSelected",value:function(){var e=this,t=this.state.flowpoints;delete t[this.state.selected],Object.keys(t).map(function(n){e.state.selected in t[n].outputs&&delete t[n].outputs[e.state.selected]}),this.setState({flowpoints:t,selected:null}),this.prepOutputShapes(),this.prepCode()}},{key:"addFlowpoint",value:function(){var e=this.state.flowpoints;e[""+this.state.count]={name:"",output_shape:[],pos:{x:this.state.lastPos.x,y:this.state.lastPos.y+90},outputs:{},isHover:!1,specs:this.state.environment.getModules().linear},this.state.selected&&(e[this.state.selected].outputs[""+this.state.count]={output:"auto",input:"auto"}),this.setState({flowpoints:e,count:this.state.count+1,lastPos:{x:this.state.lastPos.x,y:this.state.lastPos.y+90},selected:""+this.state.count}),this.prepOutputShapes(),this.prepCode()}},{key:"handleClickPoint",value:function(e,t){var n=this.state.selected,r=this.state.flowpoints;if(t.shiftKey){if(null===n)n=e;else if(n!==e){var a=r[n];e in a.outputs?delete a.outputs[e]:a.outputs[e]={output:"auto",input:"auto",onClick:this.handleClickLine}}}else n=null===n?e:n===e?null:e;this.setState({selected:n,flowpoints:r}),this.prepOutputShapes(),this.prepCode()}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{style:{backgroundColor:this.state.settings.darktheme?"black":"white"}},a.a.createElement(ue,{selected:this.state.selected,open:this.state.settings.showSidebar,flowpoints:this.state.flowpoints,settings:this.state.settings,environment:this.state.environment,refresh:function(){return e.state},updateSettings:function(t){e.setState({settings:t})},updateEnv:function(t){e.setState({environment:t})},deleteSelected:this.deleteSelected,darktheme:this.state.settings.darktheme,code:this.state.code,updatePointSettings:this.updatePointSettings,diagramRef:this.diagramRef}),a.a.createElement(d.Flowspace,{theme:this.state.settings.theme,variant:this.state.settings.variant,background:this.state.settings.darktheme?"black":"white",selected:this.state.selected,getDiagramRef:function(t){e.diagramRef=t},avoidCollisions:this.state.settings.avoidCollisions,onClick:function(t){e.setState({selected:null})},style:{height:"100vh",width:"calc(100vw - "+this.state.settings.drawerWidth*this.state.settings.showSidebar+")",marginLeft:this.state.settings.drawerWidth*this.state.settings.showSidebar+"px",transition:["margin-left 0.4s ease-out","background-color 0.2s ease-out"]}},Object.keys(this.state.flowpoints).map(function(t){var n=e.state.flowpoints[t];return a.a.createElement(d.Flowpoint,{key:t,snap:{x:10,y:10},startPosition:n.pos,outputs:n.outputs,onClick:function(n){e.handleClickPoint(t,n)},onDrag:function(n){var r=e.state.flowpoints;r[t].pos=n,e.setState({flowpoints:r,lastPos:n})},style:{height:"auto",maxHeight:e.state.settings.showShape?150:50}},a.a.createElement("div",{style:{height:"auto"}},a.a.createElement("div",{style:{display:"table",width:"100%",height:"50px"}},a.a.createElement("div",{style:{display:"table-cell",verticalAlign:"middle",textAlign:"center"}},e.state.settings.showName?""!==n.name?n.name:"p_"+t:n.specs.title)),e.state.settings.showShape?function(e){var t="[";return e.map(function(e){t+=e+","}),e.length>0&&(t=t.substring(0,t.length-1)),t+="]",a.a.createElement("div",{style:{textAlign:"center",paddingBottom:"10px"}},t)}(n.output_shape):null))})),a.a.createElement("div",{style:{bottom:"5px",left:this.state.settings.drawerWidth*this.state.settings.showSidebar+5+"px",position:"fixed",transition:"left 0.4s ease-out"}},a.a.createElement("div",{style:{paddingBottom:4}},a.a.createElement(ke.a,{style:{background:Ge.a.A400,color:"#ffffff",zIndex:6,boxShadow:"none"},"aria-label":"Add",onClick:function(){e.addFlowpoint()}},a.a.createElement(Se.a,null))),a.a.createElement("div",{style:{paddingBottom:4}},a.a.createElement(ke.a,{style:{background:Ae.a.A400,color:"#ffffff",zIndex:6,boxShadow:"none"},"aria-label":"Copy code",onClick:function(){qe()(e.state.code);var t=e.state.settings;t.snackshow=!0,t.snackmsg="Copied code to clipboard",t.snackcolor=Ae.a.A400,e.setState({settings:t})}},a.a.createElement(Oe.a,null))),a.a.createElement("div",{style:{paddingBottom:4}},a.a.createElement(ke.a,{style:{background:De.a.A400,color:"#ffffff",zIndex:6,boxShadow:"none"},"aria-label":"Copy code",onClick:function(){var t=function(e,t,n,r,a,i,s,o,l){var u=""+o[0];return u+=me(ce.indexOf(t)),u+={paper:0,outlined:1,filled:2}[n],u+=me(ce.indexOf(r)),u+=i?"D":"L",u+=s?"T":"F",u+=l?"T":"F",u+=pe[0]+me(a),Object.keys(e).map(function(t){u+=pe[0]+ge(e[t],t)}),u}(e.state.flowpoints,e.state.settings.theme,e.state.settings.variant,e.state.settings.background,e.state.count,e.state.settings.darktheme,e.state.settings.showName,e.state.environment.library,e.state.settings.showSidebar);_e(t=Qe(t,".","lll"),function(n){t=e.baseUrl+"?p="+n,qe()(t);var r=e.state.settings;r.snackshow=!0,r.snackmsg="Copied link to clipboard",r.snackcolor=De.a.A400,r.modelUrl=t,e.setState({settings:r})})}},a.a.createElement(je.a,null))),a.a.createElement("div",null,a.a.createElement(ke.a,{style:{background:He.a.A400,color:"#ffffff",zIndex:6,boxShadow:"none"},"aria-label":"Hide/Show",onClick:function(){var t=e.state.settings;t.showSidebar=!t.showSidebar,e.setState({settings:t})}},a.a.createElement(Ce.a,null)))),a.a.createElement(ze.a,{autoHideDuration:3e3,onClose:function(){var t=e.state.settings;t.snackshow=!1,e.setState({settings:t})},anchorOrigin:{vertical:"bottom",horizontal:"right"},open:this.state.settings.snackshow},a.a.createElement(Le.a,{message:this.state.settings.snackmsg,style:{backgroundColor:this.state.settings.snackcolor,color:"black"}})))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement($e,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[146,2,1]]]);
//# sourceMappingURL=main.f9d5ce91.chunk.js.map